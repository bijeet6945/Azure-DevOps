# Maven
# Build your Java project and run tests with Apache Maven.
# Add steps that analyze code, save build artifacts, deploy, and more:
# https://docs.microsoft.com/azure/devops/pipelines/languages/java 
name: '$(Rev:r)'

parameters:
- name: businessGroup
  displayName: Select a Business Group
  type: string
  default: 'APIs'
  values:
  - 'APIs'
  - 'B2B'

- name: environment
  displayName: Select an Environment
  type: string
  default: 'ALL'
  values:
  - 'ALL'
  - 'DEV'
  - 'QA'
  - 'STAGE'
  - 'PROD'

pool:
  vmImage: 'ubuntu-latest'

jobs:
- ${{ each env in parameters.environment == 'ALL' ? ['DEV', 'QA'] : [parameters.environment] }}:
  - job: BuildAndTest
    displayName: Build and Test ${{ env }}
    steps:
    - script: echo "Building the project for ${{ env }}"
      displayName: 'Run a one-line script'
    - script: |
        echo "Selected Business Group: ${{ parameters.businessGroup }}"
        echo "Selected Environment: ${{ env }}"